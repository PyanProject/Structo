### README.md

# ModelIT

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ ModelIT, –≤–∫–ª—é—á–∞—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã, –æ—Å–Ω–æ–≤–Ω—É—é –º–æ–¥–µ–ª—å –∏ –æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞.

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- `experiments/` ‚Äî –Ω–æ–≤—ã–µ –∏–¥–µ–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã.
- `main/` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å —Å –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π.
- `model-pth's/` ‚Äî –æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ (–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ).

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

#### üîπ Windows (cmd)
```bash
cd D:\gitpub\modelit
python -m venv venv
venv\Scripts\activate
```

#### üîπ Windows (PowerShell)
```powershell
cd D:\gitpub\modelit
python -m venv venv
venv\Scripts\Activate.ps1
```
‚ö† –ï—Å–ª–∏ –≤—ã–¥–∞—ë—Ç –æ—à–∏–±–∫—É "—Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—Ä–µ—â–µ–Ω—ã", –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```powershell
Set-ExecutionPolicy Unrestricted -Scope Process
```

#### üîπ macOS / Linux
```bash
cd /path/to/modelit
python3 -m venv venv
source venv/bin/activate
```

---

### 2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã:
```bash
pip install --upgrade -r requirements.txt
```

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–µ–∑ –∫—ç—à–∞:
```bash
pip install --no-cache-dir -r requirements.txt
```

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ [MAIN.md](./MAIN.md).


–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞, –∞ —Ç–∞–∫–∂–µ —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–µ–∂–¥—É —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏—è–º–∏. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫—Ä–∏–ø—Ç–µ **dataset_loader.py** –∏ –µ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é.

---

## 1. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞

–°–∫—Ä–∏–ø—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `--mode`:

- **train** ‚Äì –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (VAE-GAN) –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
- **generate** ‚Äì –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 3D –º–æ–¥–µ–ª–∏ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º—É –≤–µ–∫—Ç–æ—Ä—É –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É prompt.
- **analyze** ‚Äì –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ CLIP (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ PCA-–ø—Ä–æ–µ–∫—Ü–∏–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞).

---

## 2. –û–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏)

–ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω—ã –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞. –í —Å–∫—Ä–∏–ø—Ç–∞—Ö (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–π, —Ç–∞–∫ –∏ –≤ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏) –æ–Ω–∏ –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `argparse`.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ **–æ–±–µ–∏—Ö** –≤–µ—Ä—Å–∏—è—Ö:

- **`--mode`** (—Ç–∏–ø: _str_, *–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π*):  
  –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞. –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `train`, `generate`, `analyze`.

- **`--dataset`** (—Ç–∏–ø: _str_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `"testdataset"`):  
  –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–∏–ª–∏ –∏–º—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞) —Å —Ñ–∞–π–ª–∞–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞ **.off**, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –≤–æ–∫—Å–µ–ª–∏–∑–∞—Ü–∏–∏.

- **`--epochs`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `50`):  
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è.

- **`--batch_size`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `8`):  
  –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.

- **`--lr`** (—Ç–∏–ø: _float_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `5e-3`):  
  –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (learning rate) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞. –î–ª—è –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∑–∞–¥–∞—ë—Ç—Å—è –∫–∞–∫ `lr * 0.1`.

- **`--checkpoint`** (—Ç–∏–ø: _str_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `"vae_gan_test.pth"`):  
  –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ (–º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è/–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —ç—Ç–∏–º –∏–º–µ–Ω–µ–º).

- **`--voxel_size`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `64`):  
  –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤–æ–∫—Å–µ–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 64√ó64√ó64).

- **`--output`** (—Ç–∏–ø: _str_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `"model.obj"`):  
  –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ OBJ, –∫—É–¥–∞ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 3D –º–æ–¥–µ–ª—å.

- **`--lambda_adv`** (—Ç–∏–ø: _float_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.001`):  
  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –≤–µ—Å adversarial (—Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π) —á–∞—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.

- **`--recon_weight`** (—Ç–∏–ø: _float_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `10.0`):  
  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –≤–µ—Å–∞ –ø–æ—Ç–µ—Ä—å —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (reconstruction loss) –≤ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å VAE.

- **`--prompt`** (—Ç–∏–ø: _str_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `None`):  
  –¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (prompt) –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 3D –º–æ–¥–µ–ª–∏. –ï—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä –≤ —É—Å–ª–æ–≤–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

- **`--cond_dim`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `512`):  
  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —É—Å–ª–æ–≤–Ω–æ–≥–æ (conditional) –≤–µ–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π embedding (CLIP).

- **`--latent_dim`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `128`):  
  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –≤ VAE.

- **`--num_workers`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0`):  
  –ß–∏—Å–ª–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (data loader). –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ 0, –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

---

## 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏

–í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫, –ø–æ–∑–≤–æ–ª—è—é—â–∏—Ö –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–∞–∫ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è, —Ç–∞–∫ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥–µ–ª–µ–π.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö:

- **`--max_samples`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0`):  
  –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞. –ï—Å–ª–∏ –∑–∞–¥–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ 0, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ _max_samples_ —Ñ–∞–π–ª–æ–≤. –ï—Å–ª–∏ 0 ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Ñ–∞–π–ª—ã.

- **`--parallel`** (—Ñ–ª–∞–≥):  
  –§–ª–∞–≥, –≤–∫–ª—é—á–∞—é—â–∏–π —Ä–µ–∂–∏–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —á–∏—Å–ª–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ (`--num_workers`) –Ω–µ –∑–∞–¥–∞–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 4 –≤–æ—Ä–∫–µ—Ä–∞.

- **`--device`** (—Ç–∏–ø: _str_, –≤—ã–±–æ—Ä –∏–∑: `"auto"`, `"cpu"`, `"gpu"`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `"auto"`):  
  –í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞.  
  - `"auto"` ‚Äî —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç GPU, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ CPU;  
  - `"gpu"` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ);  
  - `"cpu"` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU.

*–í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π –º–æ–¥—É–ª—å `dataset_loader.py`.*

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º –∏ —Ç–æ—á–Ω–æ—Å—Ç—å—é –æ–±—É—á–µ–Ω–∏—è:

- **`--amp`** (—Ñ–ª–∞–≥):  
  –í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–º–µ—à–∞–Ω–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å (Automatic Mixed Precision). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ GPU –∏ —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∑–∞–¥–∞—é—â–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π:

–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ç–Ω–∫–æ–¥–µ—Ä–∞, –¥–µ–∫–æ–¥–µ—Ä–∞ –∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞.

- **`--hidden_channels`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `32`):  
  –ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤ (—Ñ–∏–ª—å—Ç—Ä–æ–≤) –≤ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è—Ö —ç–Ω–∫–æ–¥–µ—Ä–∞/–¥–µ–∫–æ–¥–µ—Ä–∞.

- **`--num_encoder_layers`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4`):  
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤ –≤ —ç–Ω–∫–æ–¥–µ—Ä–µ.

- **`--num_decoder_layers`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4`):  
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö (–∏–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö) —Å–ª–æ–µ–≤ –≤ –¥–µ–∫–æ–¥–µ—Ä–µ.

- **`--use_batch_norm`** (—Ñ–ª–∞–≥):  
  –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –≤–æ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–ª–æ–∫–∞—Ö (—ç–Ω–∫–æ–¥–µ—Ä, –¥–µ–∫–æ–¥–µ—Ä, –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä) –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (Batch Normalization).

- **`--dropout_rate`** (—Ç–∏–ø: _float_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.0`):  
  –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è Dropout –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–ª–æ—è—Ö. –ó–Ω–∞—á–µ–Ω–∏–µ 0.0 –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Dropout.

- **`--disc_hidden_channels`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `32`):  
  –ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤ –≤ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è—Ö –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞.

- **`--disc_num_layers`** (—Ç–∏–ø: _int_, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4`):  
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤ –≤ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–µ.

---

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è dataset_loader.py –∏ —Ä–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º

–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `load_dataset` –∏–∑ —Ñ–∞–π–ª–∞ **dataset_loader.py** –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≥–∏–±–∫–æ–≥–æ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏. –°–∫—Ä–∏–ø—Ç **dataset_loader.py** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- **–õ–æ–∫–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞:**  
  –§—É–Ω–∫—Ü–∏—è `select_local_dataset()` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PyQt5, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω) –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º.

- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:**  
  –í —Å–ª–æ–≤–∞—Ä–µ `DATASET_LINKS` —Ö—Ä–∞–Ω—è—Ç—Å—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `chairs`, `tables`, `modelnet40` –∏ —Ç.–¥.). –ï—Å–ª–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `--dataset` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è, —Ñ—É–Ω–∫—Ü–∏—è `load_dataset()` —Å–∫–∞—á–∞–µ—Ç –∞—Ä—Ö–∏–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞, —Ä–∞—Å–ø–∞–∫—É–µ—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `"datasets"`) –∏ –≤–µ—Ä–Ω—ë—Ç –ø—É—Ç—å –∫ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º.

- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏:**  
  –ü—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `tqdm` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏.

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:**  
  –§—É–Ω–∫—Ü–∏—è `clear_dataset_cache()` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–∫–∞—á–∞–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, –æ—Å–≤–æ–±–æ–∂–¥–∞—è –º–µ—Å—Ç–æ.

- **–ì–∏–±–∫–æ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞:**  
  –§—É–Ω–∫—Ü–∏—è `load_dataset(source, download_path="datasets")` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
  - –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É;
  - –ò–∑–≤–µ—Å—Ç–Ω–æ–µ –∏–º—è –¥–∞—Ç–∞—Å–µ—Ç–∞ (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞);
  - –ò–ª–∏ —Å–ø–∏—Å–æ–∫ —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π.  
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

*–í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `load_dataset` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–∞—Ä–∞–º–µ—Ç—Ä `--dataset` –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –ø—É—Ç–µ–º, —Ç–∞–∫ –∏ –∏–º–µ–Ω–µ–º –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ ‚Äì –≤ —Å–ª—É—á–∞–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–Ω –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω.*

---

## 5. –û–±–∑–æ—Ä —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞

### –û–±—É—á–µ–Ω–∏–µ (`--mode train`)
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ —Ä–µ–∂–∏–º–µ `train`:
- **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:**  
  –í –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –ø—É—Ç–∏ –∫ –¥–∞—Ç–∞—Å–µ—Ç—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `load_dataset` –∏–∑ **dataset_loader.py**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –ø—É—Ç—å.
  - –°–∫–∞—á–∏–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∏–º–µ–Ω–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `chairs`, `modelnet40`), –µ—Å–ª–∏ –æ–Ω–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.
  - –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `--max_samples`.

- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DataLoader:**  
  –°–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç DataLoader —Å –∑–∞–¥–∞–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –≤–æ—Ä–∫–µ—Ä–æ–≤ (–≤ —Ä–µ–∂–∏–º–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ —á–∏—Å–ª–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤).

- **–ú–æ–¥–µ–ª–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**  
  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –º–æ–¥–µ–ª–∏:
  - **CVAE_Conditional** ‚Äì –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –≤–∫–ª—é—á–∞—é—â–∞—è —ç–Ω–∫–æ–¥–µ—Ä –∏ –¥–µ–∫–æ–¥–µ—Ä, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—á–∏—Å–ª–æ —Å–ª–æ—ë–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤, BatchNorm, Dropout).
  - **Discriminator** ‚Äì –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –≤–æ–∫—Å–µ–ª—å–Ω—ã—Ö —Å–µ—Ç–æ–∫.

- **–í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ AMP:**  
  –ü–∞—Ä–∞–º–µ—Ç—Ä `--device` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (auto, gpu, cpu). –ï—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω —Ñ–ª–∞–≥ `--amp` –∏ –¥–æ—Å—Ç—É–ø–µ–Ω GPU, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–º–µ—à–∞–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å.

- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**  
  –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è `logging`), —Å–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ –∏ –ª–æ–≥–æ–≤, –∞ —Ç–∞–∫–∂–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ø–æ—Ö –ø–æ –º–µ—Ç—Ä–∏–∫–µ IoU.

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è (`--mode generate`)
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ —Ä–µ–∂–∏–º–µ `generate`:
- –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏.
- –°—ç–º–ø–ª–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä `z`.
- –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π prompt —á–µ—Ä–µ–∑ `--prompt`, –æ–Ω –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é CLIP, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä.
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–∫—Å–µ–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≥–∞—É—Å—Å–æ–≤ —Ñ–∏–ª—å—Ç—Ä.
- –ê–ª–≥–æ—Ä–∏—Ç–º marching cubes –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–æ–∫—Å–µ–ª—å–Ω—É—é —Å–µ—Ç–∫—É –≤ 3D –º–æ–¥–µ–ª—å, —Å–æ—Ö—Ä–∞–Ω—è–µ–º—É—é –≤ —Ñ–æ—Ä–º–∞—Ç–µ OBJ.
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–æ–¥–µ–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `trimesh`.

### –ê–Ω–∞–ª–∏–∑ CLIP Embeddings (`--mode analyze`)
–í —Ä–µ–∂–∏–º–µ `analyze`:
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å CLIP.
- –ö–æ–¥–∏—Ä—É—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´3d model of chair¬ª, ¬´3d model of airplane¬ª –∏ —Ç.–¥.).
- –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è PCA-–ø—Ä–æ–µ–∫—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –¥–≤—É–º–µ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≥—Ä–∞—Ñ–∏–∫–∞.

---

## 6. –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è vs. —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)

### –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è:

1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤:**  
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥—É–ª—è `logging` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –æ—Ç–ª–∞–¥–∫–∞).  
   - –°–æ–∑–¥–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (—Å –º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏) —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤–µ—Å–æ–≤, –ª–æ–≥–æ–≤ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫.  
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ –∏ –ª–æ–≥–æ–≤ –ø–æ –∏—Ç–æ–≥–∞–º –æ–±—É—á–µ–Ω–∏—è –≤ –ø–∞–ø–∫–∏ —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (–Ω–∞ –æ—Å–Ω–æ–≤–µ IoU).

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**  
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —á–∏—Å–ª–∞ —Å–ª–æ—ë–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (hidden channels), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è BatchNorm –∏ Dropout –∫–∞–∫ –≤ —ç–Ω–∫–æ–¥–µ—Ä–µ/–¥–µ–∫–æ–¥–µ—Ä–µ, —Ç–∞–∫ –∏ –≤ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–µ.  
   - –ú–æ–¥–µ–ª–∏ VoxelEncoder, ConditionalVoxelDecoder –∏ Discriminator —Å—Ç–∞–ª–∏ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ–º—ã–º–∏.

3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ AMP –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞:**  
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–º–µ—à–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (AMP) –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ GPU.  
   - –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `--parallel` –¥–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö.

4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ —á–µ—Ä–µ–∑ dataset_loader.py:**  
   - –§—É–Ω–∫—Ü–∏—è `load_dataset` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏, —Å–∫–∞—á–∏–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –ø–æ –∏–º–µ–Ω–∞–º, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏, –∞ —Ç–∞–∫–∂–µ –æ—á–∏—â–∞—Ç—å –∫—ç—à —Å–∫–∞—á–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
   - –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–∞—Ä–∞–º–µ—Ç—Ä `--dataset` —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å, —Ç–∞–∫ –∏ –∏–º—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `chairs`), –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω.

5. **–£–ª—É—á—à–µ–Ω–∏—è –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏:**  
   - –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –ø–æ—Ä–æ–≥–∞ –¥–ª—è marching cubes 0.5 –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–∫—Å–µ–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏).

6. **–í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**  
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `--device` –¥–ª—è —è–≤–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (auto, cpu, gpu) —Å –≤—ã–≤–æ–¥–æ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ VRAM GPU –∏–ª–∏ RAM —Å–∏—Å—Ç–µ–º—ã).

### –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è:

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–µ–π –±—ã–ª–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—á–∏—Å–ª–æ —Å–ª–æ—ë–≤, BatchNorm, Dropout –∏ —Ç.–¥.).
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª–æ—Å—å –ø—Ä–æ—Å—Ç—ã–º –≤—ã–≤–æ–¥–æ–º –≤ –∫–æ–Ω—Å–æ–ª—å (–±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–≥-—Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π).
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ AMP –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.
- –ù–µ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ –æ–±—Ä–∞–∑—Ü–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `--max_samples`.
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è GPU, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏).
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–ø–∫–∏.
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–∞—Å—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

---

## 7. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (—Å –±–∞–∑–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏):**

```bash
python script.py --mode train --dataset path/to/dataset --epochs 100 --batch_size 8
```

**–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è):**

```bash
python script.py --mode train --dataset chairs --epochs 50 --batch_size 16 --lr 0.001 \
    --hidden_channels 64 --num_encoder_layers 5 --num_decoder_layers 5 --use_batch_norm \
    --dropout_rate 0.1 --amp --device gpu --max_samples 500
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3D –º–æ–¥–µ–ª–∏ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º prompt:**

```bash
python script.py --mode generate --prompt "3d model of modern chair" --output modern_chair.obj
```

**–ê–Ω–∞–ª–∏–∑ CLIP embeddings:**

```bash
python script.py --mode analyze
```

**–†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º —á–µ—Ä–µ–∑ dataset_loader.py (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º):**

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç **dataset_loader.py** –Ω–∞–ø—Ä—è–º—É—é, —á—Ç–æ–±—ã:
- –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.
- –í—ã–±—Ä–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º (–ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º PyQt5).
- –°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –ø–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –∏–º–µ–Ω–∏ –∏–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à —Å–∫–∞—á–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

```bash
python dataset_loader.py
```

---

–≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Ñ–∞–π–ª README –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Å–∫—Ä–∏–ø—Ç–∞, –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º —á–µ—Ä–µ–∑ **dataset_loader.py**.